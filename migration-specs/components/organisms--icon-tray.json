{
  "id": "ui/components/organisms/IconTray.tsx:IconTray",
  "name": "IconTray",
  "source": {
    "path": "/home/crook/dev/wraith/wraith-framework/src/ui/components/organisms/IconTray.tsx",
    "code": "import React, { useRef, useCallback } from 'react'\nimport { IconTrayItem } from '../molecules'\n\nexport interface PanelConfig {\n  id: string\n  name: string\n  icon: React.ReactNode\n}\n\nexport interface IconTrayProps {\n  panels: PanelConfig[]\n  activePanel: string | null\n  side: 'left' | 'right'\n  isNarrow?: boolean\n  onPanelClick: (panelId: string) => void\n  onPanelReorder?: (fromIndex: number, toIndex: number) => void\n  dragOverTray?: boolean\n  onTrayDragOver?: (e: React.DragEvent) => void\n  onTrayDragLeave?: (e: React.DragEvent) => void\n}\n\nexport const IconTray: React.FC<IconTrayProps> = ({\n  panels,\n  activePanel,\n  side,\n  isNarrow = false,\n  onPanelClick,\n  onPanelReorder,\n  dragOverTray = false,\n  onTrayDragOver,\n  onTrayDragLeave,\n}) => {\n  const draggedIndex = useRef<number | null>(null)\n  const dragOverIndex = useRef<number | null>(null)\n\n  const handleDragStart = useCallback((index: number) => (e: React.DragEvent) => {\n    draggedIndex.current = index\n    e.dataTransfer.effectAllowed = 'move'\n  }, [])\n\n  const handleDragOver = useCallback((index: number) => (e: React.DragEvent) => {\n    e.preventDefault()\n    e.dataTransfer.dropEffect = 'move'\n    dragOverIndex.current = index\n  }, [])\n\n  const handleDrop = useCallback((toIndex: number) => (e: React.DragEvent) => {\n    e.preventDefault()\n    if (draggedIndex.current !== null && draggedIndex.current !== toIndex) {\n      onPanelReorder?.(draggedIndex.current, toIndex)\n    }\n    draggedIndex.current = null\n    dragOverIndex.current = null\n  }, [onPanelReorder])\n\n  const handleDragEnd = useCallback(() => {\n    draggedIndex.current = null\n    dragOverIndex.current = null\n  }, [])\n\n  const handleKeyDown = useCallback((index: number, panelId: string) => (e: React.KeyboardEvent) => {\n    if (e.key === 'ArrowUp' || e.key === 'ArrowLeft') {\n      e.preventDefault()\n      const prevIndex = index > 0 ? index - 1 : panels.length - 1\n      const prevElement = document.querySelector(`[data-tray-index=\"${prevIndex}\"]`) as HTMLElement\n      prevElement?.focus()\n    } else if (e.key === 'ArrowDown' || e.key === 'ArrowRight') {\n      e.preventDefault()\n      const nextIndex = index < panels.length - 1 ? index + 1 : 0\n      const nextElement = document.querySelector(`[data-tray-index=\"${nextIndex}\"]`) as HTMLElement\n      nextElement?.focus()\n    } else if (e.key === 'Escape') {\n      if (activePanel === panelId) {\n        onPanelClick(panelId) // Toggle off\n      }\n    }\n  }, [panels.length, activePanel, onPanelClick])\n\n  return (\n    <div\n      data-testid={`${side}-icon-tray`}\n      role=\"toolbar\"\n      aria-label={`${side} panel toolbar`}\n      aria-orientation={isNarrow ? 'horizontal' : 'vertical'}\n      onDragOver={onTrayDragOver}\n      onDragLeave={onTrayDragLeave}\n      className={`\n        flex bg-[var(--bg-secondary)] transition-colors duration-200\n        ${isNarrow\n          ? 'w-full h-[var(--icon-tray-width)] flex-row border-b overflow-x-auto overflow-y-hidden'\n          : 'w-[var(--icon-tray-width)] min-w-[var(--icon-tray-width)] flex-col overflow-y-auto'\n        }\n        ${side === 'left' ? 'border-r' : 'border-l'} border-[var(--border-primary)]\n        ${dragOverTray ? 'bg-[var(--accent-hover)] shadow-[inset_0_0_0_2px_var(--accent-primary)]' : ''}\n      `}\n    >\n      {panels.map((panel, index) => (\n        <div key={panel.id} data-tray-index={index}>\n          <IconTrayItem\n            icon={panel.icon}\n            label={panel.name}\n            active={activePanel === panel.id}\n            side={side}\n            onClick={() => onPanelClick(panel.id)}\n            onDragStart={handleDragStart(index)}\n            onDragOver={handleDragOver(index)}\n            onDrop={handleDrop(index)}\n            onDragEnd={handleDragEnd}\n            onKeyDown={handleKeyDown(index, panel.id)}\n          />\n        </div>\n      ))}\n    </div>\n  )\n}\n",
    "extraction": {
      "name": "IconTray",
      "component_type": "functional",
      "exported": true,
      "export_type": "named",
      "location": {
        "start_line": 22,
        "start_col": 49,
        "end_line": 115,
        "end_col": 1
      },
      "props": [
        {
          "name": "panels",
          "type_annotation": null,
          "required": true,
          "default_value": null,
          "is_callback": false,
          "is_children": false
        },
        {
          "name": "activePanel",
          "type_annotation": null,
          "required": true,
          "default_value": null,
          "is_callback": false,
          "is_children": false
        },
        {
          "name": "side",
          "type_annotation": null,
          "required": true,
          "default_value": null,
          "is_callback": false,
          "is_children": false
        },
        {
          "name": "isNarrow",
          "type_annotation": null,
          "required": false,
          "default_value": "false",
          "is_callback": false,
          "is_children": false
        },
        {
          "name": "onPanelClick",
          "type_annotation": null,
          "required": true,
          "default_value": null,
          "is_callback": true,
          "is_children": false
        },
        {
          "name": "onPanelReorder",
          "type_annotation": null,
          "required": true,
          "default_value": null,
          "is_callback": true,
          "is_children": false
        },
        {
          "name": "dragOverTray",
          "type_annotation": null,
          "required": false,
          "default_value": "false",
          "is_callback": false,
          "is_children": false
        },
        {
          "name": "onTrayDragOver",
          "type_annotation": null,
          "required": true,
          "default_value": null,
          "is_callback": true,
          "is_children": false
        },
        {
          "name": "onTrayDragLeave",
          "type_annotation": null,
          "required": true,
          "default_value": null,
          "is_callback": true,
          "is_children": false
        }
      ],
      "props_type": null,
      "hooks": [
        {
          "hook_type": "useRef",
          "location": {
            "start_line": 33,
            "start_col": 23,
            "end_line": 33,
            "end_col": 50
          },
          "state_name": null,
          "setter_name": null,
          "initial_value": null,
          "dependencies": null,
          "has_cleanup": false,
          "memoized_deps": null,
          "ref_name": "draggedIndex",
          "ref_type": "/* type */",
          "context_name": null,
          "reducer_name": null,
          "action_types": []
        },
        {
          "hook_type": "useRef",
          "location": {
            "start_line": 34,
            "start_col": 24,
            "end_line": 34,
            "end_col": 51
          },
          "state_name": null,
          "setter_name": null,
          "initial_value": null,
          "dependencies": null,
          "has_cleanup": false,
          "memoized_deps": null,
          "ref_name": "dragOverIndex",
          "ref_type": "/* type */",
          "context_name": null,
          "reducer_name": null,
          "action_types": []
        },
        {
          "hook_type": "useCallback",
          "location": {
            "start_line": 36,
            "start_col": 26,
            "end_line": 39,
            "end_col": 8
          },
          "state_name": null,
          "setter_name": null,
          "initial_value": null,
          "dependencies": null,
          "has_cleanup": false,
          "memoized_deps": [],
          "ref_name": null,
          "ref_type": null,
          "context_name": null,
          "reducer_name": null,
          "action_types": []
        },
        {
          "hook_type": "useCallback",
          "location": {
            "start_line": 41,
            "start_col": 25,
            "end_line": 45,
            "end_col": 8
          },
          "state_name": null,
          "setter_name": null,
          "initial_value": null,
          "dependencies": null,
          "has_cleanup": false,
          "memoized_deps": [],
          "ref_name": null,
          "ref_type": null,
          "context_name": null,
          "reducer_name": null,
          "action_types": []
        },
        {
          "hook_type": "useCallback",
          "location": {
            "start_line": 47,
            "start_col": 21,
            "end_line": 54,
            "end_col": 22
          },
          "state_name": null,
          "setter_name": null,
          "initial_value": null,
          "dependencies": null,
          "has_cleanup": false,
          "memoized_deps": [
            "onPanelReorder"
          ],
          "ref_name": null,
          "ref_type": null,
          "context_name": null,
          "reducer_name": null,
          "action_types": []
        },
        {
          "hook_type": "useCallback",
          "location": {
            "start_line": 56,
            "start_col": 24,
            "end_line": 59,
            "end_col": 8
          },
          "state_name": null,
          "setter_name": null,
          "initial_value": null,
          "dependencies": null,
          "has_cleanup": false,
          "memoized_deps": [],
          "ref_name": null,
          "ref_type": null,
          "context_name": null,
          "reducer_name": null,
          "action_types": []
        },
        {
          "hook_type": "useCallback",
          "location": {
            "start_line": 61,
            "start_col": 24,
            "end_line": 77,
            "end_col": 48
          },
          "state_name": null,
          "setter_name": null,
          "initial_value": null,
          "dependencies": null,
          "has_cleanup": false,
          "memoized_deps": [
            "/* expr */",
            "activePanel",
            "onPanelClick"
          ],
          "ref_name": null,
          "ref_type": null,
          "context_name": null,
          "reducer_name": null,
          "action_types": []
        }
      ],
      "custom_hooks": [],
      "class_info": null,
      "jsx": {
        "root": {
          "node_type": {
            "type": "Element",
            "tag": "div",
            "is_component": false,
            "attributes": [
              {
                "name": "data-testid",
                "value": {
                  "type": "Expression",
                  "code": "`${side}-icon-tray`"
                },
                "is_event_handler": false
              },
              {
                "name": "role",
                "value": {
                  "type": "String",
                  "value": "toolbar"
                },
                "is_event_handler": false
              },
              {
                "name": "aria-label",
                "value": {
                  "type": "Expression",
                  "code": "`${side} panel toolbar`"
                },
                "is_event_handler": false
              },
              {
                "name": "aria-orientation",
                "value": {
                  "type": "Expression",
                  "code": "isNarrow ? 'horizontal' : 'vertical'"
                },
                "is_event_handler": false
              },
              {
                "name": "onDragOver",
                "value": {
                  "type": "Expression",
                  "code": "onTrayDragOver"
                },
                "is_event_handler": true
              },
              {
                "name": "onDragLeave",
                "value": {
                  "type": "Expression",
                  "code": "onTrayDragLeave"
                },
                "is_event_handler": true
              },
              {
                "name": "className",
                "value": {
                  "type": "Expression",
                  "code": "`\n        flex bg-[var(--bg-secondary)] transition-colors duration-200\n        ${isNarrow\n          ? 'w-full h-[var(--icon-tray-width)] flex-row border-b overflow-x-auto overflow-y-hidden'\n          : 'w-[var(--icon-tray-width)] min-w-[var(--icon-tray-width)] flex-col overflow-y-auto'\n        }\n        ${side === 'left' ? 'border-r' : 'border-l'} border-[var(--border-primary)]\n        ${dragOverTray ? 'bg-[var(--accent-hover)] shadow-[inset_0_0_0_2px_var(--accent-primary)]' : ''}\n      `"
                },
                "is_event_handler": false
              }
            ],
            "children": [
              {
                "node_type": {
                  "type": "Map",
                  "iterable": "panels",
                  "item_name": "panel",
                  "key_expr": "panel.id",
                  "body": {
                    "node_type": {
                      "type": "Element",
                      "tag": "div",
                      "is_component": false,
                      "attributes": [
                        {
                          "name": "key",
                          "value": {
                            "type": "Expression",
                            "code": "panel.id"
                          },
                          "is_event_handler": false
                        },
                        {
                          "name": "data-tray-index",
                          "value": {
                            "type": "Expression",
                            "code": "index"
                          },
                          "is_event_handler": false
                        }
                      ],
                      "children": [
                        {
                          "node_type": {
                            "type": "Element",
                            "tag": "IconTrayItem",
                            "is_component": true,
                            "attributes": [
                              {
                                "name": "icon",
                                "value": {
                                  "type": "Expression",
                                  "code": "panel.icon"
                                },
                                "is_event_handler": false
                              },
                              {
                                "name": "label",
                                "value": {
                                  "type": "Expression",
                                  "code": "panel.name"
                                },
                                "is_event_handler": false
                              },
                              {
                                "name": "active",
                                "value": {
                                  "type": "Expression",
                                  "code": "activePanel === panel.id"
                                },
                                "is_event_handler": false
                              },
                              {
                                "name": "side",
                                "value": {
                                  "type": "Expression",
                                  "code": "side"
                                },
                                "is_event_handler": false
                              },
                              {
                                "name": "onClick",
                                "value": {
                                  "type": "Expression",
                                  "code": "() => onPanelClick(panel.id)"
                                },
                                "is_event_handler": true
                              },
                              {
                                "name": "onDragStart",
                                "value": {
                                  "type": "Expression",
                                  "code": "handleDragStart(index)"
                                },
                                "is_event_handler": true
                              },
                              {
                                "name": "onDragOver",
                                "value": {
                                  "type": "Expression",
                                  "code": "handleDragOver(index)"
                                },
                                "is_event_handler": true
                              },
                              {
                                "name": "onDrop",
                                "value": {
                                  "type": "Expression",
                                  "code": "handleDrop(index)"
                                },
                                "is_event_handler": true
                              },
                              {
                                "name": "onDragEnd",
                                "value": {
                                  "type": "Expression",
                                  "code": "handleDragEnd"
                                },
                                "is_event_handler": true
                              },
                              {
                                "name": "onKeyDown",
                                "value": {
                                  "type": "Expression",
                                  "code": "handleKeyDown(index, panel.id)"
                                },
                                "is_event_handler": true
                              }
                            ],
                            "children": []
                          },
                          "location": {
                            "start_line": 99,
                            "start_col": 10,
                            "end_line": 110,
                            "end_col": 12
                          }
                        }
                      ]
                    },
                    "location": {
                      "start_line": 98,
                      "start_col": 8,
                      "end_line": 111,
                      "end_col": 14
                    }
                  }
                },
                "location": {
                  "start_line": 97,
                  "start_col": 6,
                  "end_line": 112,
                  "end_col": 9
                }
              }
            ]
          },
          "location": {
            "start_line": 80,
            "start_col": 4,
            "end_line": 113,
            "end_col": 10
          }
        }
      },
      "handlers": [],
      "child_components": [
        "IconTrayItem"
      ],
      "architecture": {
        "service_actors": [],
        "state_ownership": [],
        "communication_patterns": [],
        "zustand_stores": []
      }
    }
  },
  "target": {
    "suggested_path": "src/components/icon_tray.sigil",
    "pattern": "actor"
  },
  "recommendations": {
    "state_fields": [
      {
        "from_hook": "useRef:draggedIndex",
        "to_field": "draggedIndex",
        "field_type": "Option</* type */>",
        "evidentiality": "!",
        "initial_value": "∅",
        "reasoning": "useRef 'draggedIndex' becomes non-reactive state (no re-render on change)"
      },
      {
        "from_hook": "useRef:dragOverIndex",
        "to_field": "dragOverIndex",
        "field_type": "Option</* type */>",
        "evidentiality": "!",
        "initial_value": "∅",
        "reasoning": "useRef 'dragOverIndex' becomes non-reactive state (no re-render on change)"
      }
    ],
    "messages": [],
    "effects": [
      {
        "from_hook": "UseCallback",
        "strategy": "remove",
        "reasoning": "useCallback/useMemo not needed in actors - no re-render optimization needed",
        "inline_in": null,
        "lifecycle_event": null
      },
      {
        "from_hook": "UseCallback",
        "strategy": "remove",
        "reasoning": "useCallback/useMemo not needed in actors - no re-render optimization needed",
        "inline_in": null,
        "lifecycle_event": null
      },
      {
        "from_hook": "UseCallback",
        "strategy": "remove",
        "reasoning": "useCallback/useMemo not needed in actors - no re-render optimization needed",
        "inline_in": null,
        "lifecycle_event": null
      },
      {
        "from_hook": "UseCallback",
        "strategy": "remove",
        "reasoning": "useCallback/useMemo not needed in actors - no re-render optimization needed",
        "inline_in": null,
        "lifecycle_event": null
      },
      {
        "from_hook": "UseCallback",
        "strategy": "remove",
        "reasoning": "useCallback/useMemo not needed in actors - no re-render optimization needed",
        "inline_in": null,
        "lifecycle_event": null
      }
    ],
    "props_handling": {
      "strategy": "constructor",
      "fields": [
        {
          "name": "panels",
          "field_type": "Any",
          "from_prop": "panels"
        },
        {
          "name": "active_panel",
          "field_type": "Any",
          "from_prop": "activePanel"
        },
        {
          "name": "side",
          "field_type": "Any",
          "from_prop": "side"
        },
        {
          "name": "is_narrow",
          "field_type": "Any",
          "from_prop": "isNarrow"
        },
        {
          "name": "on_panel_click",
          "field_type": "Any",
          "from_prop": "onPanelClick"
        },
        {
          "name": "on_panel_reorder",
          "field_type": "Any",
          "from_prop": "onPanelReorder"
        },
        {
          "name": "drag_over_tray",
          "field_type": "Any",
          "from_prop": "dragOverTray"
        },
        {
          "name": "on_tray_drag_over",
          "field_type": "Any",
          "from_prop": "onTrayDragOver"
        },
        {
          "name": "on_tray_drag_leave",
          "field_type": "Any",
          "from_prop": "onTrayDragLeave"
        }
      ]
    }
  },
  "patterns": [
    {
      "name": "useRef_to_state",
      "description": "Convert useRef to non-reactive state field",
      "react": "const inputRef = useRef<HTMLInputElement>(null);",
      "sigil": "state input_ref: Option<Element>! = ∅,"
    },
    {
      "name": "useCallback_remove",
      "description": "useCallback is not needed in actors",
      "react": "const handleClick = useCallback(() => { ... }, [dep]);",
      "sigil": "// No equivalent needed - actors don't re-render like React"
    },
    {
      "name": "jsx_to_builder",
      "description": "Convert JSX element to VNode builder",
      "react": "<div className=\"container\" id=\"main\">\n  <h1>Title</h1>\n  <p>Content</p>\n</div>",
      "sigil": "VNode·div()\n    ·class(\"container\")\n    ·id(\"main\")\n    ·child(VNode·h1()·text(\"Title\"))\n    ·child(VNode·p()·text(\"Content\"))"
    },
    {
      "name": "onClick_to_message",
      "description": "Convert onClick handler to message dispatch",
      "react": "<button onClick={() => setCount(c => c + 1)}>",
      "sigil": "VNode·button()·on_click(Increment)"
    }
  ],
  "ambiguities": [
    {
      "id": "callback_prop_onPanelClick",
      "category": "event_mapping",
      "question": "How should callback prop 'onPanelClick' be handled?",
      "options": [
        {
          "label": "Message dispatch",
          "description": "Parent passes a message ID, child dispatches to parent",
          "recommended": true
        },
        {
          "label": "Actor reference",
          "description": "Parent passes a reference, child sends messages to parent actor",
          "recommended": false
        }
      ],
      "default_choice": 0
    },
    {
      "id": "callback_prop_onPanelReorder",
      "category": "event_mapping",
      "question": "How should callback prop 'onPanelReorder' be handled?",
      "options": [
        {
          "label": "Message dispatch",
          "description": "Parent passes a message ID, child dispatches to parent",
          "recommended": true
        },
        {
          "label": "Actor reference",
          "description": "Parent passes a reference, child sends messages to parent actor",
          "recommended": false
        }
      ],
      "default_choice": 0
    },
    {
      "id": "callback_prop_onTrayDragOver",
      "category": "event_mapping",
      "question": "How should callback prop 'onTrayDragOver' be handled?",
      "options": [
        {
          "label": "Message dispatch",
          "description": "Parent passes a message ID, child dispatches to parent",
          "recommended": true
        },
        {
          "label": "Actor reference",
          "description": "Parent passes a reference, child sends messages to parent actor",
          "recommended": false
        }
      ],
      "default_choice": 0
    },
    {
      "id": "callback_prop_onTrayDragLeave",
      "category": "event_mapping",
      "question": "How should callback prop 'onTrayDragLeave' be handled?",
      "options": [
        {
          "label": "Message dispatch",
          "description": "Parent passes a message ID, child dispatches to parent",
          "recommended": true
        },
        {
          "label": "Actor reference",
          "description": "Parent passes a reference, child sends messages to parent actor",
          "recommended": false
        }
      ],
      "default_choice": 0
    }
  ],
  "dependencies": {
    "components": [
      "IconTrayItem"
    ],
    "types": []
  },
  "complexity": "simple",
  "complexity_factors": [],
  "status": "pending"
}