invoke qliphothÂ·preludeÂ·*;
á›ˆ SprintPanelMsg {
    UpdateActiveSprint,
    UpdateStats,
    UpdateTasks,
    UpdateVelocity,
    UpdateLoading,
    UpdateError,
}
actor SprintPanel {
    state activeSprint: Option<Any>~ = None,
    state stats: Option<Any>~ = None,
    state tasks: Vec<Any>! = [],
    state velocity: Vec<Any>! = [],
    state loading: bool! = True,
    state error: Option<Any>~ = None,

    on UpdateActiveSprint {
        self.activeSprint = msg.0;
    }

    on UpdateStats {
        self.stats = msg.0;
    }

    on UpdateTasks {
        self.tasks = msg.0;
    }

    on UpdateVelocity {
        self.velocity = msg.0;
    }

    on UpdateLoading {
        self.loading = msg.0;
    }

    on UpdateError {
        self.error = msg.0;
    }

    rite view(self) -> VNode! {
        VNodeÂ·div()
            Â·class("flex flex-col h-full bg-[#1e1e1e] text-[#cccccc] overflow-hidden")
            Â·child(
            VNodeÂ·div()
                Â·class("p-4 border-b border-[#3c3c3c] bg-[#252526]")
                Â·child(
                VNodeÂ·div()
                    Â·class("text-lg font-semibold text-white mb-2")
                    Â·text_child("ðŸƒ")
                    Â·text_child(active_sprint.nameÂ·to_string())
                )
                Â·when(active_sprint.goal, VNodeÂ·div()
                    Â·class("text-[13px] text-[#b0b0b0] mb-3 italic")
                    Â·text_child("\"")
                    Â·text_child(active_sprint.goalÂ·to_string())
                    Â·text_child("\""))
                Â·child(
                VNodeÂ·span()
                    Â·class("inline-block px-3 py-1 rounded-xl text-[11px] font-semibold uppercase ")
                    Â·text_child(active_sprint.statusÂ·to_string())
                )
                Â·child(
                VNodeÂ·div()
                    Â·class("text-[11px] text-[#808080] mt-2")
                    Â·text_child(new date(active_sprint.start_date).to_locale_date_string()Â·to_string())
                    Â·text_child("-")
                    Â·text_child(new date(active_sprint.end_date).to_locale_date_string()Â·to_string())
                    Â·text_child(stats âˆ§ " â€¢  days remaining"Â·to_string())
                )
            )
            Â·when(stats âˆ§ stats.warnings.len() > 0, VNodeÂ·div()
                Â·class("p-4 pb-0")
                // Map: âˆ€ warning âˆˆ stats.warnings
                Â·children(self.stats.warnings.iter().map(|warning| VNodeÂ·div()
                        Â·attr("key", self.idx)
                        Â·class("p-3 bg-[rgba(255,215,0,0.1)] border border-[#ffd700] rounded-md mb-4")
                        Â·child(
                        VNodeÂ·div()
                            Â·class("text-xs text-[#ffd700]")
                            Â·text_child("âš ï¸")
                            Â·text_child(warningÂ·to_string())
                        )).collect()))
            Â·when(self.stats, VNodeÂ·div()
                Â·class("grid grid-cols-2 gap-3 p-4 border-b border-[#3c3c3c]")
                Â·child(
                VNodeÂ·div()
                    Â·class("p-3 bg-[#252526] rounded-md border border-[#3c3c3c]")
                    Â·child(
                    VNodeÂ·div()
                        Â·class("text-[11px] text-[#808080] uppercase mb-1.5")
                        Â·text_child("Progress")
                    )
                    Â·child(
                    VNodeÂ·div()
                        Â·class("text-2xl font-bold text-white")
                        Â·text_child(self.stats.completion_percentageÂ·to_string())
                        Â·text_child("%")
                    )
                    Â·child(
                    VNodeÂ·div()
                        Â·class("text-[11px] text-[#b0b0b0] mt-1")
                        Â·text_child(self.stats.completed_tasksÂ·to_string())
                        Â·text_child("of")
                        Â·text_child(self.stats.total_tasksÂ·to_string())
                        Â·text_child("tasks")
                    )
                    Â·child(
                    VNodeÂ·div()
                        Â·class("h-1.5 bg-[#3c3c3c] rounded-sm overflow-hidden mt-2")
                        Â·child(
                        VNodeÂ·div()
                            Â·class("h-full bg-[#00ff7f] transition-all duration-300")
                            Â·style(âˆ…)
                        )
                    )
                )
                Â·child(
                VNodeÂ·div()
                    Â·class("p-3 bg-[#252526] rounded-md border border-[#3c3c3c]")
                    Â·child(
                    VNodeÂ·div()
                        Â·class("text-[11px] text-[#808080] uppercase mb-1.5")
                        Â·text_child("Story Points")
                    )
                    Â·child(
                    VNodeÂ·div()
                        Â·class("text-2xl font-bold text-white")
                        Â·text_child(self.stats.completed_story_points.to_fixed(0)Â·to_string())
                    )
                    Â·child(
                    VNodeÂ·div()
                        Â·class("text-[11px] text-[#b0b0b0] mt-1")
                        Â·text_child("of")
                        Â·text_child(self.stats.total_story_points.to_fixed(0)Â·to_string())
                        Â·text_child("points")
                    )
                    Â·child(
                    VNodeÂ·div()
                        Â·class("h-1.5 bg-[#3c3c3c] rounded-sm overflow-hidden mt-2")
                        Â·child(
                        VNodeÂ·div()
                            Â·class("h-full bg-[#9d00ff] transition-all duration-300")
                            Â·style(âˆ…)
                        )
                    )
                ))
            Â·child(
            VNodeÂ·div()
                Â·class("flex-1 overflow-auto p-4")
                Â·child(
                VNodeÂ·div()
                    Â·class("mb-6")
                    Â·child(
                    VNodeÂ·div()
                        Â·class("text-sm font-semibold text-white mb-3 flex items-center gap-2")
                        Â·text_child("ðŸ“‹ Sprint Tasks (")
                        Â·text_child(self.tasks.len()Â·to_string())
                        Â·text_child(")")
                    )
                    Â·when_else(self.tasks.len() > 0, VNodeÂ·div()
                        Â·class("flex flex-col gap-2")
                        // Map: âˆ€ task âˆˆ tasks
                        Â·children(self.tasks.iter().map(|task| VNodeÂ·div()
                                Â·attr("key", task.id)
                                Â·class("p-3 bg-[#252526] rounded-md border border-[#3c3c3c] cursor-pointer transition-all hover:bg-[#2d2d30] hover:border-[#5bcefa]")
                                Â·child(
                                VNodeÂ·div()
                                    Â·class("text-[13px] text-white mb-1")
                                    Â·text_child(task.titleÂ·to_string())
                                )
                                Â·child(
                                VNodeÂ·div()
                                    Â·class("text-[11px] text-[#808080]")
                                    Â·text_child(task.statusÂ·to_string())
                                    Â·text_child(task.story_points âˆ§ " â€¢  pts"Â·to_string())
                                    Â·text_child(task.assignee âˆ§ " â€¢ "Â·to_string())
                                )).collect()), VNodeÂ·div()
                        Â·class("text-center py-5 text-[#808080] text-xs")
                        Â·text_child("No tasks in this sprint"))
                )
                Â·when(self.velocity.len() > 0, VNodeÂ·div()
                    Â·class("mb-6")
                    Â·child(
                    VNodeÂ·div()
                        Â·class("text-sm font-semibold text-white mb-3 flex items-center gap-2")
                        Â·text_child("ðŸ“ˆ Team Velocity (Last 5 Sprints)")
                    )
                    Â·child(
                    VNodeÂ·div()
                        Â·class("mt-4 p-4 bg-[#252526] rounded-md border border-[#3c3c3c]")
                        Â·child(
                        VNodeÂ·div()
                            Â·class("flex items-end gap-3 h-[120px] mt-4")
                            // Map: âˆ€ point âˆˆ velocity
                            Â·children(self.velocity.iter().map(|point| VNodeÂ·div()
                                    Â·attr("key", point.sprint_id)
                                    Â·class("flex-1 flex flex-col items-center gap-2")
                                    Â·child(
                                    VNodeÂ·div()
                                        Â·class("w-full bg-[#5bcefa] rounded-t transition-all duration-300")
                                        Â·style(âˆ…)
                                        Â·attr("title", " pts completed")
                                    )
                                    Â·child(
                                    VNodeÂ·div()
                                        Â·class("text-[10px] text-[#808080] text-center")
                                        Â·text_child(point.sprint_name.substring(0, 10)Â·to_string())
                                        Â·text_child("...")
                                        Â·child(
                                        VNodeÂ·br()
                                        )
                                        Â·text_child(point.completed_points.to_fixed(0)Â·to_string())
                                        Â·text_child("pts")
                                    )).collect())
                        )
                        Â·when(self.stats, VNodeÂ·div()
                            Â·class("mt-4 text-xs text-[#b0b0b0] text-center")
                            Â·text_child("Average Velocity:")
                            Â·text_child(self.stats.average_velocity.to_fixed(1)Â·to_string())
                            Â·text_child("points/sprint"))
                    ))
            )
    }
}