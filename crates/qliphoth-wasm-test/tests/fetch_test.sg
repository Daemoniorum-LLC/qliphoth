// Fetch System Test
// Tests HTTP fetch API

pub fn main() -> i64 {
    console::log_str("=== Fetch Test ===");

    // Start a GET request
    console::log_str("Starting GET request to /api/users...");
    let handle1 = fetch::start("/api/users", "", "");
    console::print(handle1 as i64);

    // Start another request
    console::log_str("Starting GET request to /data/items...");
    let handle2 = fetch::start("/data/items", "", "");
    console::print(handle2 as i64);

    // Start POST request
    console::log_str("Starting POST request to /api/create...");
    let handle3 = fetch::start("/api/create", "POST", "{\"name\": \"test\"}");
    console::print(handle3 as i64);

    // Poll requests (will be pending since async hasn't completed)
    console::log_str("Polling handle1...");
    let status1 = fetch::poll(handle1);
    console::print(status1 as i64);

    console::log_str("Polling handle2...");
    let status2 = fetch::poll(handle2);
    console::print(status2 as i64);

    // Start an error request
    console::log_str("Starting request to /error...");
    let handle_err = fetch::start("/error", "", "");

    // Abort a request
    console::log_str("Aborting handle2...");
    fetch::abort(handle2);

    console::log_str("Fetch test complete!");
    0
}
