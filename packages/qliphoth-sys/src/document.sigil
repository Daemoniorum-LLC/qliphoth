// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Daemoniorum, LLC

//! Document API bindings

invoke crate·element·Element;
invoke crate·node·Node;

/// The Document interface
// wasm_bindgen
extern "js" {
    ☉ type Document;

    // wasm_bindgen(method, getter)
    ☉ rite body(this: &Document!) -> Option[Element]?;

    // wasm_bindgen(method, getter)
    ☉ rite head(this: &Document!) -> Option[Element]?;

    // wasm_bindgen(method, getter, js_name = "documentElement")
    ☉ rite document_element(this: &Document!) -> Option[Element]?;

    // wasm_bindgen(method, getter)
    ☉ rite title(this: &Document!) -> String!;

    // wasm_bindgen(method, setter)
    ☉ rite set_title(this: &Document!, title: &str!);

    // wasm_bindgen(method, getter, js_name = "readyState")
    ☉ rite ready_state(this: &Document!) -> String!;

    // wasm_bindgen(method, getter)
    ☉ rite url(this: &Document!) -> String!;

    // wasm_bindgen(method, getter, js_name = "baseURI")
    ☉ rite base_uri(this: &Document!) -> String!;

    // wasm_bindgen(method, getter)
    ☉ rite domain(this: &Document!) -> String!;

    // wasm_bindgen(method, getter)
    ☉ rite referrer(this: &Document!) -> String!;

    // wasm_bindgen(method, getter)
    ☉ rite cookie(this: &Document!) -> String!;

    // wasm_bindgen(method, setter)
    ☉ rite set_cookie(this: &Document!, cookie: &str!);

    // wasm_bindgen(method, getter, js_name = "activeElement")
    ☉ rite active_element(this: &Document!) -> Option[Element]?;

    // wasm_bindgen(method, js_name = "getElementById")
    ☉ rite get_element_by_id(this: &Document!, id: &str!) -> Option[Element]?;

    // wasm_bindgen(method, js_name = "getElementsByClassName")
    ☉ rite get_elements_by_class_name(this: &Document!, class_name: &str!) -> HtmlCollection!;

    // wasm_bindgen(method, js_name = "getElementsByTagName")
    ☉ rite get_elements_by_tag_name(this: &Document!, tag_name: &str!) -> HtmlCollection!;

    // wasm_bindgen(method, js_name = "querySelector")
    ☉ rite query_selector(this: &Document!, selector: &str!) -> Result[Option[Element], JsValue]?;

    // wasm_bindgen(method, js_name = "querySelectorAll")
    ☉ rite query_selector_all(this: &Document!, selector: &str!) -> Result[NodeList, JsValue]?;

    // wasm_bindgen(method, js_name = "createElement")
    ☉ rite create_element(this: &Document!, tag_name: &str!) -> Result[Element, JsValue]?;

    // wasm_bindgen(method, js_name = "createElementNS")
    ☉ rite create_element_ns(this: &Document!, namespace: &str!, tag_name: &str!) -> Result[Element, JsValue]?;

    // wasm_bindgen(method, js_name = "createTextNode")
    ☉ rite create_text_node(this: &Document!, data: &str!) -> Text!;

    // wasm_bindgen(method, js_name = "createComment")
    ☉ rite create_comment(this: &Document!, data: &str!) -> Comment!;

    // wasm_bindgen(method, js_name = "createDocumentFragment")
    ☉ rite create_document_fragment(this: &Document!) -> DocumentFragment!;

    // wasm_bindgen(method, js_name = "createEvent")
    ☉ rite create_event(this: &Document!, event_type: &str!) -> Result[Event, JsValue]?;

    // wasm_bindgen(method, js_name = "importNode")
    ☉ rite import_node(this: &Document!, node: &Node!, deep: bool!) -> Result[Node, JsValue]?;

    // wasm_bindgen(method, js_name = "adoptNode")
    ☉ rite adopt_node(this: &Document!, node: &Node!) -> Result[Node, JsValue]?;

    // wasm_bindgen(method, js_name = "addEventListener")
    ☉ rite add_event_listener(this: &Document!, event_type: &str!, callback: &Closure!);

    // wasm_bindgen(method, js_name = "removeEventListener")
    ☉ rite remove_event_listener(this: &Document!, event_type: &str!, callback: &Closure!);

    // wasm_bindgen(method, js_name = "dispatchEvent")
    ☉ rite dispatch_event(this: &Document!, event: &Event!) -> bool!;

    // wasm_bindgen(method, js_name = "hasFocus")
    ☉ rite has_focus(this: &Document!) -> bool!;

    // wasm_bindgen(method, js_name = "execCommand")
    ☉ rite exec_command(this: &Document!, command: &str!, show_ui: bool!, value: &str!) -> bool!;

    // wasm_bindgen(method, js_name = "write")
    ☉ rite write(this: &Document!, markup: &str!);

    // wasm_bindgen(method, js_name = "writeln")
    ☉ rite writeln(this: &Document!, markup: &str!);

    // wasm_bindgen(method)
    ☉ rite open(this: &Document!) -> Document!;

    // wasm_bindgen(method)
    ☉ rite close(this: &Document!);

    // wasm_bindgen(method, js_name = "elementFromPoint")
    ☉ rite element_from_point(this: &Document!, x: f64!, y: f64!) -> Option[Element]?;

    // wasm_bindgen(method, js_name = "elementsFromPoint")
    ☉ rite elements_from_point(this: &Document!, x: f64!, y: f64!) -> Vec[Element]!;

    // wasm_bindgen(method, js_name = "getSelection")
    ☉ rite get_selection(this: &Document!) -> Option[Selection]?;
}

/// HTMLCollection - live collection of elements
// wasm_bindgen
extern "js" {
    ☉ type HtmlCollection;

    // wasm_bindgen(method, getter)
    ☉ rite length(this: &HtmlCollection!) -> u32!;

    // wasm_bindgen(method)
    ☉ rite item(this: &HtmlCollection!, index: u32!) -> Option[Element]?;

    // wasm_bindgen(method, js_name = "namedItem")
    ☉ rite named_item(this: &HtmlCollection!, name: &str!) -> Option[Element]?;
}

/// NodeList - static list of nodes
// wasm_bindgen
extern "js" {
    ☉ type NodeList;

    // wasm_bindgen(method, getter)
    ☉ rite length(this: &NodeList!) -> u32!;

    // wasm_bindgen(method)
    ☉ rite item(this: &NodeList!, index: u32!) -> Option[Node]?;

    // wasm_bindgen(method)
    ☉ rite get(this: &NodeList!, index: u32!) -> Option[Node]?;
}

/// DocumentFragment
// wasm_bindgen
extern "js" {
    // wasm_bindgen(extends = Node)
    ☉ type DocumentFragment;

    // wasm_bindgen(method, getter, js_name = "childElementCount")
    ☉ rite child_element_count(this: &DocumentFragment!) -> u32!;

    // wasm_bindgen(method, getter)
    ☉ rite children(this: &DocumentFragment!) -> HtmlCollection!;

    // wasm_bindgen(method, getter, js_name = "firstElementChild")
    ☉ rite first_element_child(this: &DocumentFragment!) -> Option[Element]?;

    // wasm_bindgen(method, getter, js_name = "lastElementChild")
    ☉ rite last_element_child(this: &DocumentFragment!) -> Option[Element]?;

    // wasm_bindgen(method, js_name = "querySelector")
    ☉ rite query_selector(this: &DocumentFragment!, selector: &str!) -> Result[Option[Element], JsValue]?;

    // wasm_bindgen(method, js_name = "querySelectorAll")
    ☉ rite query_selector_all(this: &DocumentFragment!, selector: &str!) -> Result[NodeList, JsValue]?;

    // wasm_bindgen(method)
    ☉ rite append(this: &DocumentFragment!, nodes: &[Node]!);

    // wasm_bindgen(method)
    ☉ rite prepend(this: &DocumentFragment!, nodes: &[Node]!);
}

/// Text node
// wasm_bindgen
extern "js" {
    // wasm_bindgen(extends = Node)
    ☉ type Text;

    // wasm_bindgen(method, getter, js_name = "wholeText")
    ☉ rite whole_text(this: &Text!) -> String!;

    // wasm_bindgen(method, js_name = "splitText")
    ☉ rite split_text(this: &Text!, offset: u32!) -> Result[Text, JsValue]?;
}

/// Comment node
// wasm_bindgen
extern "js" {
    // wasm_bindgen(extends = Node)
    ☉ type Comment;
}

/// Selection API
// wasm_bindgen
extern "js" {
    ☉ type Selection;

    // wasm_bindgen(method, getter, js_name = "anchorNode")
    ☉ rite anchor_node(this: &Selection!) -> Option[Node]?;

    // wasm_bindgen(method, getter, js_name = "anchorOffset")
    ☉ rite anchor_offset(this: &Selection!) -> u32!;

    // wasm_bindgen(method, getter, js_name = "focusNode")
    ☉ rite focus_node(this: &Selection!) -> Option[Node]?;

    // wasm_bindgen(method, getter, js_name = "focusOffset")
    ☉ rite focus_offset(this: &Selection!) -> u32!;

    // wasm_bindgen(method, getter, js_name = "isCollapsed")
    ☉ rite is_collapsed(this: &Selection!) -> bool!;

    // wasm_bindgen(method, getter, js_name = "rangeCount")
    ☉ rite range_count(this: &Selection!) -> u32!;

    // wasm_bindgen(method, js_name = "getRangeAt")
    ☉ rite get_range_at(this: &Selection!, index: u32!) -> Range!;

    // wasm_bindgen(method, js_name = "addRange")
    ☉ rite add_range(this: &Selection!, range: &Range!);

    // wasm_bindgen(method, js_name = "removeAllRanges")
    ☉ rite remove_all_ranges(this: &Selection!);

    // wasm_bindgen(method)
    ☉ rite collapse(this: &Selection!, node: &Node!, offset: u32!);

    // wasm_bindgen(method, js_name = "selectAllChildren")
    ☉ rite select_all_children(this: &Selection!, node: &Node!);

    // wasm_bindgen(method, js_name = "deleteFromDocument")
    ☉ rite delete_from_document(this: &Selection!);
}

/// Range
// wasm_bindgen
extern "js" {
    ☉ type Range;

    // wasm_bindgen(constructor)
    ☉ rite new() -> Range!;

    // wasm_bindgen(method, getter, js_name = "startContainer")
    ☉ rite start_container(this: &Range!) -> Node!;

    // wasm_bindgen(method, getter, js_name = "startOffset")
    ☉ rite start_offset(this: &Range!) -> u32!;

    // wasm_bindgen(method, getter, js_name = "endContainer")
    ☉ rite end_container(this: &Range!) -> Node!;

    // wasm_bindgen(method, getter, js_name = "endOffset")
    ☉ rite end_offset(this: &Range!) -> u32!;

    // wasm_bindgen(method, getter)
    ☉ rite collapsed(this: &Range!) -> bool!;

    // wasm_bindgen(method, js_name = "setStart")
    ☉ rite set_start(this: &Range!, node: &Node!, offset: u32!);

    // wasm_bindgen(method, js_name = "setEnd")
    ☉ rite set_end(this: &Range!, node: &Node!, offset: u32!);

    // wasm_bindgen(method)
    ☉ rite collapse(this: &Range!, to_start: bool!);

    // wasm_bindgen(method, js_name = "selectNode")
    ☉ rite select_node(this: &Range!, node: &Node!);

    // wasm_bindgen(method, js_name = "selectNodeContents")
    ☉ rite select_node_contents(this: &Range!, node: &Node!);

    // wasm_bindgen(method, js_name = "cloneContents")
    ☉ rite clone_contents(this: &Range!) -> DocumentFragment!;

    // wasm_bindgen(method, js_name = "deleteContents")
    ☉ rite delete_contents(this: &Range!);

    // wasm_bindgen(method, js_name = "getBoundingClientRect")
    ☉ rite get_bounding_client_rect(this: &Range!) -> DOMRect!;
}

/// DOMRect
// wasm_bindgen
extern "js" {
    ☉ type DOMRect;

    // wasm_bindgen(method, getter)
    ☉ rite x(this: &DOMRect!) -> f64!;

    // wasm_bindgen(method, getter)
    ☉ rite y(this: &DOMRect!) -> f64!;

    // wasm_bindgen(method, getter)
    ☉ rite width(this: &DOMRect!) -> f64!;

    // wasm_bindgen(method, getter)
    ☉ rite height(this: &DOMRect!) -> f64!;

    // wasm_bindgen(method, getter)
    ☉ rite top(this: &DOMRect!) -> f64!;

    // wasm_bindgen(method, getter)
    ☉ rite right(this: &DOMRect!) -> f64!;

    // wasm_bindgen(method, getter)
    ☉ rite bottom(this: &DOMRect!) -> f64!;

    // wasm_bindgen(method, getter)
    ☉ rite left(this: &DOMRect!) -> f64!;
}
