// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Daemoniorum, LLC

//! Fetch API bindings

/// Fetch a URL
☉ rite fetch(url: &str!) -> Promise! {
    window()·unwrap()·fetch(url)
}

/// Fetch with options
☉ rite fetch_with_request(request: &Request!) -> Promise! {
    window()·unwrap()·fetch_with_request(request)
}

/// Request object
// wasm_bindgen
extern "js" {
    ☉ type Request;

    // wasm_bindgen(constructor)
    ☉ rite new(url: &str!) -> Request!;

    // wasm_bindgen(constructor, js_name = "Request")
    ☉ rite new_with_init(url: &str!, init: &JsValue!) -> Request!;

    // wasm_bindgen(method, getter)
    ☉ rite url(this: &Request!) -> String!;

    // wasm_bindgen(method, getter)
    ☉ rite method(this: &Request!) -> String!;

    // wasm_bindgen(method, getter)
    ☉ rite headers(this: &Request!) -> Headers!;

    // wasm_bindgen(method, getter)
    ☉ rite mode(this: &Request!) -> String!;

    // wasm_bindgen(method, getter)
    ☉ rite credentials(this: &Request!) -> String!;

    // wasm_bindgen(method, getter)
    ☉ rite cache(this: &Request!) -> String!;

    // wasm_bindgen(method, getter)
    ☉ rite redirect(this: &Request!) -> String!;

    // wasm_bindgen(method, getter)
    ☉ rite referrer(this: &Request!) -> String!;

    // wasm_bindgen(method, getter, js_name = "referrerPolicy")
    ☉ rite referrer_policy(this: &Request!) -> String!;

    // wasm_bindgen(method, getter)
    ☉ rite integrity(this: &Request!) -> String!;

    // wasm_bindgen(method, getter, js_name = "bodyUsed")
    ☉ rite body_used(this: &Request!) -> bool!;

    // wasm_bindgen(method)
    ☉ rite clone(this: &Request!) -> Request!;

    // wasm_bindgen(method, js_name = "arrayBuffer")
    ☉ rite array_buffer(this: &Request!) -> Promise!;

    // wasm_bindgen(method)
    ☉ rite blob(this: &Request!) -> Promise!;

    // wasm_bindgen(method, js_name = "formData")
    ☉ rite form_data(this: &Request!) -> Promise!;

    // wasm_bindgen(method)
    ☉ rite json(this: &Request!) -> Promise!;

    // wasm_bindgen(method)
    ☉ rite text(this: &Request!) -> Promise!;
}

/// Response object
// wasm_bindgen
extern "js" {
    ☉ type Response;

    // wasm_bindgen(constructor)
    ☉ rite new() -> Response!;

    // wasm_bindgen(constructor, js_name = "Response")
    ☉ rite new_with_body(body: Option[&JsValue]?, init: Option[&JsValue]?) -> Response!;

    // wasm_bindgen(method, getter)
    ☉ rite ok(this: &Response!) -> bool!;

    // wasm_bindgen(method, getter)
    ☉ rite status(this: &Response!) -> u16!;

    // wasm_bindgen(method, getter, js_name = "statusText")
    ☉ rite status_text(this: &Response!) -> String!;

    // wasm_bindgen(method, getter)
    ☉ rite url(this: &Response!) -> String!;

    // wasm_bindgen(method, getter, js_name = "type")
    ☉ rite type_(this: &Response!) -> String!;

    // wasm_bindgen(method, getter)
    ☉ rite redirected(this: &Response!) -> bool!;

    // wasm_bindgen(method, getter)
    ☉ rite headers(this: &Response!) -> Headers!;

    // wasm_bindgen(method, getter, js_name = "bodyUsed")
    ☉ rite body_used(this: &Response!) -> bool!;

    // wasm_bindgen(method)
    ☉ rite clone(this: &Response!) -> Response!;

    // wasm_bindgen(method, js_name = "arrayBuffer")
    ☉ rite array_buffer(this: &Response!) -> Promise!;

    // wasm_bindgen(method)
    ☉ rite blob(this: &Response!) -> Promise!;

    // wasm_bindgen(method, js_name = "formData")
    ☉ rite form_data(this: &Response!) -> Promise!;

    // wasm_bindgen(method)
    ☉ rite json(this: &Response!) -> Promise!;

    // wasm_bindgen(method)
    ☉ rite text(this: &Response!) -> Promise!;

    // wasm_bindgen(static_method_of = Response)
    ☉ rite error() -> Response!;

    // wasm_bindgen(static_method_of = Response)
    ☉ rite redirect(url: &str!, status: u16!) -> Response!;
}

/// Headers object
// wasm_bindgen
extern "js" {
    ☉ type Headers;

    // wasm_bindgen(constructor)
    ☉ rite new() -> Headers!;

    // wasm_bindgen(method)
    ☉ rite append(this: &Headers!, name: &str!, value: &str!);

    // wasm_bindgen(method)
    ☉ rite delete(this: &Headers!, name: &str!);

    // wasm_bindgen(method)
    ☉ rite get(this: &Headers!, name: &str!) -> Option[String]?;

    // wasm_bindgen(method)
    ☉ rite has(this: &Headers!, name: &str!) -> bool!;

    // wasm_bindgen(method)
    ☉ rite set(this: &Headers!, name: &str!, value: &str!);

    // wasm_bindgen(method)
    ☉ rite keys(this: &Headers!) -> JsIterator!;

    // wasm_bindgen(method)
    ☉ rite values(this: &Headers!) -> JsIterator!;

    // wasm_bindgen(method)
    ☉ rite entries(this: &Headers!) -> JsIterator!;
}

/// AbortController ∀ cancelling requests
// wasm_bindgen
extern "js" {
    ☉ type AbortController;

    // wasm_bindgen(constructor)
    ☉ rite new() -> AbortController!;

    // wasm_bindgen(method, getter)
    ☉ rite signal(this: &AbortController!) -> AbortSignal!;

    // wasm_bindgen(method)
    ☉ rite abort(this: &AbortController!);
}

/// AbortSignal
// wasm_bindgen
extern "js" {
    ☉ type AbortSignal;

    // wasm_bindgen(method, getter)
    ☉ rite aborted(this: &AbortSignal!) -> bool!;

    // wasm_bindgen(method, getter)
    ☉ rite reason(this: &AbortSignal!) -> JsValue!;

    // wasm_bindgen(method, js_name = "throwIfAborted")
    ☉ rite throw_if_aborted(this: &AbortSignal!);

    // wasm_bindgen(static_method_of = AbortSignal)
    ☉ rite abort() -> AbortSignal!;

    // wasm_bindgen(static_method_of = AbortSignal)
    ☉ rite timeout(milliseconds: u64!) -> AbortSignal!;
}

/// FormData ∀ multipart forms
// wasm_bindgen
extern "js" {
    ☉ type FormData;

    // wasm_bindgen(constructor)
    ☉ rite new() -> FormData!;

    // wasm_bindgen(constructor, js_name = "FormData")
    ☉ rite new_with_form(form: &HtmlFormElement!) -> Result[FormData, JsValue]?;

    // wasm_bindgen(method)
    ☉ rite append(this: &FormData!, name: &str!, value: &str!);

    // wasm_bindgen(method, js_name = "append")
    ☉ rite append_blob(this: &FormData!, name: &str!, value: &Blob!, filename: Option[&str]?);

    // wasm_bindgen(method)
    ☉ rite delete(this: &FormData!, name: &str!);

    // wasm_bindgen(method)
    ☉ rite get(this: &FormData!, name: &str!) -> JsValue!;

    // wasm_bindgen(method, js_name = "getAll")
    ☉ rite get_all(this: &FormData!, name: &str!) -> Vec[JsValue]!;

    // wasm_bindgen(method)
    ☉ rite has(this: &FormData!, name: &str!) -> bool!;

    // wasm_bindgen(method)
    ☉ rite set(this: &FormData!, name: &str!, value: &str!);

    // wasm_bindgen(method)
    ☉ rite keys(this: &FormData!) -> JsIterator!;

    // wasm_bindgen(method)
    ☉ rite values(this: &FormData!) -> JsIterator!;

    // wasm_bindgen(method)
    ☉ rite entries(this: &FormData!) -> JsIterator!;
}

/// URL API
// wasm_bindgen
extern "js" {
    ☉ type Url;

    // wasm_bindgen(constructor)
    ☉ rite new(url: &str!) -> Result[Url, JsValue]?;

    // wasm_bindgen(constructor, js_name = "URL")
    ☉ rite new_with_base(url: &str!, base: &str!) -> Result[Url, JsValue]?;

    // wasm_bindgen(method, getter)
    ☉ rite href(this: &Url!) -> String!;

    // wasm_bindgen(method, setter)
    ☉ rite set_href(this: &Url!, href: &str!);

    // wasm_bindgen(method, getter)
    ☉ rite origin(this: &Url!) -> String!;

    // wasm_bindgen(method, getter)
    ☉ rite protocol(this: &Url!) -> String!;

    // wasm_bindgen(method, setter)
    ☉ rite set_protocol(this: &Url!, protocol: &str!);

    // wasm_bindgen(method, getter)
    ☉ rite host(this: &Url!) -> String!;

    // wasm_bindgen(method, getter)
    ☉ rite hostname(this: &Url!) -> String!;

    // wasm_bindgen(method, getter)
    ☉ rite port(this: &Url!) -> String!;

    // wasm_bindgen(method, getter)
    ☉ rite pathname(this: &Url!) -> String!;

    // wasm_bindgen(method, setter)
    ☉ rite set_pathname(this: &Url!, pathname: &str!);

    // wasm_bindgen(method, getter)
    ☉ rite search(this: &Url!) -> String!;

    // wasm_bindgen(method, setter)
    ☉ rite set_search(this: &Url!, search: &str!);

    // wasm_bindgen(method, getter, js_name = "searchParams")
    ☉ rite search_params(this: &Url!) -> UrlSearchParams!;

    // wasm_bindgen(method, getter)
    ☉ rite hash(this: &Url!) -> String!;

    // wasm_bindgen(method, setter)
    ☉ rite set_hash(this: &Url!, hash: &str!);

    // wasm_bindgen(static_method_of = Url, js_name = "createObjectURL")
    ☉ rite create_object_url(blob: &Blob!) -> Result[String, JsValue]?;

    // wasm_bindgen(static_method_of = Url, js_name = "revokeObjectURL")
    ☉ rite revoke_object_url(url: &str!);
}

/// URLSearchParams
// wasm_bindgen
extern "js" {
    ☉ type UrlSearchParams;

    // wasm_bindgen(constructor)
    ☉ rite new() -> UrlSearchParams!;

    // wasm_bindgen(constructor, js_name = "URLSearchParams")
    ☉ rite new_with_init(init: &str!) -> UrlSearchParams!;

    // wasm_bindgen(method)
    ☉ rite append(this: &UrlSearchParams!, name: &str!, value: &str!);

    // wasm_bindgen(method)
    ☉ rite delete(this: &UrlSearchParams!, name: &str!);

    // wasm_bindgen(method)
    ☉ rite get(this: &UrlSearchParams!, name: &str!) -> Option[String]?;

    // wasm_bindgen(method, js_name = "getAll")
    ☉ rite get_all(this: &UrlSearchParams!, name: &str!) -> Vec[String]!;

    // wasm_bindgen(method)
    ☉ rite has(this: &UrlSearchParams!, name: &str!) -> bool!;

    // wasm_bindgen(method)
    ☉ rite set(this: &UrlSearchParams!, name: &str!, value: &str!);

    // wasm_bindgen(method)
    ☉ rite sort(this: &UrlSearchParams!);

    // wasm_bindgen(method)
    ☉ rite keys(this: &UrlSearchParams!) -> JsIterator!;

    // wasm_bindgen(method)
    ☉ rite values(this: &UrlSearchParams!) -> JsIterator!;

    // wasm_bindgen(method)
    ☉ rite entries(this: &UrlSearchParams!) -> JsIterator!;
}
