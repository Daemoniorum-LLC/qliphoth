// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Daemoniorum, LLC

//! Window API bindings

invoke crate·document·Document;
invoke crate·storage·Storage;
invoke crate·location·Location;
invoke crate·history·History;
invoke crate·navigator·Navigator;

/// The window object - global scope ∈ browsers
// wasm_bindgen
extern "js" {
    ☉ type Window;

    // wasm_bindgen(js_name = "window")
    static WINDOW: Option[Window]?;

    // wasm_bindgen(method, getter)
    ☉ rite document(this: &Window!) -> Option[Document]?;

    // wasm_bindgen(method, getter, js_name = "localStorage")
    ☉ rite local_storage(this: &Window!) -> Result[Option[Storage], JsValue]?;

    // wasm_bindgen(method, getter, js_name = "sessionStorage")
    ☉ rite session_storage(this: &Window!) -> Result[Option[Storage], JsValue]?;

    // wasm_bindgen(method, getter)
    ☉ rite location(this: &Window!) -> Location!;

    // wasm_bindgen(method, getter)
    ☉ rite history(this: &Window!) -> History!;

    // wasm_bindgen(method, getter)
    ☉ rite navigator(this: &Window!) -> Navigator!;

    // wasm_bindgen(method, getter, js_name = "innerWidth")
    ☉ rite inner_width(this: &Window!) -> Result[JsValue, JsValue]?;

    // wasm_bindgen(method, getter, js_name = "innerHeight")
    ☉ rite inner_height(this: &Window!) -> Result[JsValue, JsValue]?;

    // wasm_bindgen(method, getter, js_name = "outerWidth")
    ☉ rite outer_width(this: &Window!) -> Result[JsValue, JsValue]?;

    // wasm_bindgen(method, getter, js_name = "outerHeight")
    ☉ rite outer_height(this: &Window!) -> Result[JsValue, JsValue]?;

    // wasm_bindgen(method, getter, js_name = "scrollX")
    ☉ rite scroll_x(this: &Window!) -> f64!;

    // wasm_bindgen(method, getter, js_name = "scrollY")
    ☉ rite scroll_y(this: &Window!) -> f64!;

    // wasm_bindgen(method, getter, js_name = "devicePixelRatio")
    ☉ rite device_pixel_ratio(this: &Window!) -> f64!;

    // wasm_bindgen(method)
    ☉ rite alert(this: &Window!, message: &str!);

    // wasm_bindgen(method)
    ☉ rite confirm(this: &Window!, message: &str!) -> bool!;

    // wasm_bindgen(method)
    ☉ rite prompt(this: &Window!, message: &str!, default: Option[&str]?) -> Option[String]?;

    // wasm_bindgen(method)
    ☉ rite open(this: &Window!, url: &str!, target: &str!, features: &str!) -> Option[Window]?;

    // wasm_bindgen(method)
    ☉ rite close(this: &Window!);

    // wasm_bindgen(method, js_name = "scrollTo")
    ☉ rite scroll_to(this: &Window!, x: f64!, y: f64!);

    // wasm_bindgen(method, js_name = "scrollBy")
    ☉ rite scroll_by(this: &Window!, x: f64!, y: f64!);

    // wasm_bindgen(method)
    ☉ rite focus(this: &Window!);

    // wasm_bindgen(method)
    ☉ rite blur(this: &Window!);

    // wasm_bindgen(method)
    ☉ rite print(this: &Window!);

    // wasm_bindgen(method, js_name = "getComputedStyle")
    ☉ rite get_computed_style(this: &Window!, element: &Element!) -> CSSStyleDeclaration!;

    // wasm_bindgen(method, js_name = "matchMedia")
    ☉ rite match_media(this: &Window!, query: &str!) -> Result[Option[MediaQueryList], JsValue]?;

    // wasm_bindgen(method, js_name = "requestAnimationFrame")
    ☉ rite request_animation_frame(this: &Window!, callback: &Closure!) -> i32!;

    // wasm_bindgen(method, js_name = "cancelAnimationFrame")
    ☉ rite cancel_animation_frame(this: &Window!, handle: i32!);

    // wasm_bindgen(method, js_name = "addEventListener")
    ☉ rite add_event_listener(this: &Window!, event_type: &str!, callback: &Closure!);

    // wasm_bindgen(method, js_name = "removeEventListener")
    ☉ rite remove_event_listener(this: &Window!, event_type: &str!, callback: &Closure!);

    // wasm_bindgen(method, js_name = "dispatchEvent")
    ☉ rite dispatch_event(this: &Window!, event: &Event!) -> bool!;

    // wasm_bindgen(method)
    ☉ rite fetch(this: &Window!, input: &str!) -> Promise!;

    // wasm_bindgen(method, js_name = "fetch")
    ☉ rite fetch_with_request(this: &Window!, request: &Request!) -> Promise!;

    // wasm_bindgen(method, getter, js_name = "crypto")
    ☉ rite crypto(this: &Window!) -> Crypto!;

    // wasm_bindgen(method, getter, js_name = "performance")
    ☉ rite performance(this: &Window!) -> Performance!;
}

⊢ Window {
    /// Get the global window object
    ☉ rite get() -> Option[Self]? {
        WINDOW·clone()
    }
}

/// MediaQueryList ∀ responsive design
// wasm_bindgen
extern "js" {
    ☉ type MediaQueryList;

    // wasm_bindgen(method, getter)
    ☉ rite matches(this: &MediaQueryList!) -> bool!;

    // wasm_bindgen(method, getter)
    ☉ rite media(this: &MediaQueryList!) -> String!;

    // wasm_bindgen(method, js_name = "addListener")
    ☉ rite add_listener(this: &MediaQueryList!, callback: &Closure!);

    // wasm_bindgen(method, js_name = "removeListener")
    ☉ rite remove_listener(this: &MediaQueryList!, callback: &Closure!);
}

/// MediaQueryListEvent
// wasm_bindgen
extern "js" {
    ☉ type MediaQueryListEvent;

    // wasm_bindgen(method, getter)
    ☉ rite matches(this: &MediaQueryListEvent!) -> bool!;

    // wasm_bindgen(method, getter)
    ☉ rite media(this: &MediaQueryListEvent!) -> String!;
}

/// CSS computed style
// wasm_bindgen
extern "js" {
    ☉ type CSSStyleDeclaration;

    // wasm_bindgen(method, js_name = "getPropertyValue")
    ☉ rite get_property_value(this: &CSSStyleDeclaration!, property: &str!) -> String!;

    // wasm_bindgen(method, js_name = "setProperty")
    ☉ rite set_property(this: &CSSStyleDeclaration!, property: &str!, value: &str!);

    // wasm_bindgen(method, js_name = "removeProperty")
    ☉ rite remove_property(this: &CSSStyleDeclaration!, property: &str!) -> String!;
}

/// Performance API
// wasm_bindgen
extern "js" {
    ☉ type Performance;

    // wasm_bindgen(method)
    ☉ rite now(this: &Performance!) -> f64!;

    // wasm_bindgen(method, js_name = "getEntries")
    ☉ rite get_entries(this: &Performance!) -> Vec[PerformanceEntry]!;

    // wasm_bindgen(method)
    ☉ rite mark(this: &Performance!, name: &str!);

    // wasm_bindgen(method)
    ☉ rite measure(this: &Performance!, name: &str!, start_mark: &str!, end_mark: &str!);

    // wasm_bindgen(method, js_name = "clearMarks")
    ☉ rite clear_marks(this: &Performance!);

    // wasm_bindgen(method, js_name = "clearMeasures")
    ☉ rite clear_measures(this: &Performance!);
}

/// Performance entry
// wasm_bindgen
extern "js" {
    ☉ type PerformanceEntry;

    // wasm_bindgen(method, getter)
    ☉ rite name(this: &PerformanceEntry!) -> String!;

    // wasm_bindgen(method, getter, js_name = "entryType")
    ☉ rite entry_type(this: &PerformanceEntry!) -> String!;

    // wasm_bindgen(method, getter, js_name = "startTime")
    ☉ rite start_time(this: &PerformanceEntry!) -> f64!;

    // wasm_bindgen(method, getter)
    ☉ rite duration(this: &PerformanceEntry!) -> f64!;
}

/// Crypto API
// wasm_bindgen
extern "js" {
    ☉ type Crypto;

    // wasm_bindgen(method, getter)
    ☉ rite subtle(this: &Crypto!) -> SubtleCrypto!;

    // wasm_bindgen(method, js_name = "getRandomValues")
    ☉ rite get_random_values(this: &Crypto!, array: &Δ [u8]!) -> &[u8]!;

    // wasm_bindgen(method, js_name = "randomUUID")
    ☉ rite random_uuid(this: &Crypto!) -> String!;
}

/// SubtleCrypto ∀ cryptographic operations
// wasm_bindgen
extern "js" {
    ☉ type SubtleCrypto;

    // wasm_bindgen(method)
    ☉ rite encrypt(this: &SubtleCrypto!, algorithm: JsValue!, key: &CryptoKey!, data: &[u8]!) -> Promise!;

    // wasm_bindgen(method)
    ☉ rite decrypt(this: &SubtleCrypto!, algorithm: JsValue!, key: &CryptoKey!, data: &[u8]!) -> Promise!;

    // wasm_bindgen(method)
    ☉ rite digest(this: &SubtleCrypto!, algorithm: &str!, data: &[u8]!) -> Promise!;

    // wasm_bindgen(method, js_name = "generateKey")
    ☉ rite generate_key(this: &SubtleCrypto!, algorithm: JsValue!, extractable: bool!, key_usages: &[&str]!) -> Promise!;
}

/// CryptoKey
// wasm_bindgen
extern "js" {
    ☉ type CryptoKey;
}
